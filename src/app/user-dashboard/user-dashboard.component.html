<div class="px-4 py-8 font-sans text-gray-900 max-w-[77vw] ml-[20vw]">
  <div class="flex flex-col md:flex-row items-center mb-4">
    <div class="w-32 h-32 md:w-40 md:h-40 mb-6 md:mb-0 md:mr-10 flex-shrink-0">
      <img
        [src]="this.currentUserData?.userProfilePhoto || 'data:image/png;base64,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'"
        [alt]="this.currentUserData?.user?.name"
        class="w-full h-full rounded-full object-cover border-4 border-blue-200 p-1 transition-transform duration-300 hover:scale-105"
      />
    </div>
    <div class="flex-1 text-center md:text-left">
      <div class="flex flex-col md:flex-row items-center md:items-end mb-2">
        <h1 class="text-3xl font-bold text-gray-800 mb-2 md:mb-0 md:mr-4">
          {{ this.currentUserData?.user?.username }}
        </h1>
      </div>
      <div class="text-left">
        <h2 class="text-xl text-gray-600 font-medium">
          {{ this.currentUserData?.username }}
        </h2>
        <p class="text-gray-700 leading-relaxed">{{ this.currentUserData?.bio }}</p>
      </div>


      
    </div>
    <div class="relative">
      <!-- Three dots -->
      <button 
        class="text-xl p-2 rounded-full hover:bg-gray-200" 
        (click)="toggleOptionsMenu()"
        aria-label="Toggle menu"
      >
        &#x22EE;
      </button>
    
      <!-- Dropdown menu -->
      <ul 
        *ngIf="menuOpen" 
        class="absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10"
      >
      @if (isProfilePresent) {
        <li 
        (click)="editProfile(this.currentUserData?.userProfilePhoto,this.currentUserData?.username, this.currentUserData?.bio)"
          class="px-4 py-2 hover:bg-gray-100 cursor-pointer"
        >
          Update Profile
        </li>
      }
      @else {
        <li 
          (click)="createProfile()" 
          class="px-4 py-2 hover:bg-gray-100 cursor-pointer"
        >
          Create Profile
        </li>
      }
        <li 
        (click)="openDeleteConfirmation()"
          class="px-4 py-2 hover:bg-gray-100 cursor-pointer text-red-600"
        >
          Delete Profile
        </li>
      </ul>
    </div>
  </div>


  <!-- Confirmation Modal -->
<div *ngIf="showConfirmation" class="fixed inset-0 bg-gray-500 bg-opacity-50 flex items-center justify-center z-20">
  <div class="bg-white p-6 rounded-lg shadow-lg max-w-xs w-full">
    <h3 class="text-xl font-semibold mb-4">Are you sure you want to delete this profile?</h3>
    <div class="flex justify-end space-x-4">
      <button 
        (click)="deleteProfile()" 
        class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
      >
        Yes, Delete
      </button>
      <button 
        (click)="cancelDelete()" 
        class="px-4 py-2 bg-gray-300 text-black rounded-lg hover:bg-gray-400"
      >
        Cancel
      </button>
    </div>
  </div>
</div>

<hr class="border-gray-700 pb-4 border-2">

@if (postDoneByUser?.length == 0 ) {
  <div class="flex items-center justify-center min-h-[60vh] p-4 sm:p-6 lg:p-8">
    <div 
      class="w-full max-w-md mx-auto text-center bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 ease-in-out hover:shadow-lg"
      role="alert"
      aria-live="polite"
    >
      <div class="p-6 sm:p-8">
        <div class="flex justify-center mb-4">
          <svg class="w-12 h-12 text-yellow-500 animate-pulse" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
          </svg>
        </div>
        <h2 class="text-xl sm:text-2xl font-bold text-gray-900 mb-2">
          No Posts to Display
        </h2>
        <p class="text-base sm:text-lg text-gray-600">
          It looks like there aren't any posts yet. Why not create one?
        </p>
      </div>
      <div class="px-6 pb-6 sm:px-8 sm:pb-8">
        <button
        (click)="redirectToPost()"
          class="w-full bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50"
        >
          Create Your First Post
        </button>
      </div>
    </div>
  </div>
  
  


    }
    @else {
      <div class="grid grid-cols-3 gap-4">

      <div
        *ngFor="let post of postDoneByUser; let i = index"
        class="bg-white shadow rounded-lg overflow-hidden relative"
      >
        <img
          [src]="post.postMedia"
          alt="Post Image"
          class="w-full h-48 object-cover"
        />
        <div class="p-4">
          <h2 class="text-lg font-semibold">{{ post.caption }}</h2>
          <p class="text-sm text-gray-600">{{ post.address }}</p>
          <div class="mt-4 flex justify-between items-center">
            <span class="text-sm text-gray-500">
              Uploaded: {{ post.uploadedDate | date: 'mediumDate' }}
            </span>
            <span class="text-sm text-gray-500">
              Expires: {{ post.expiryDate | date: 'mediumDate' }}
            </span>
          </div>
        </div>
  
        <!-- Three-dot Menu Button -->
        <div class="absolute top-2 right-2">
          <button
            class="p-2 rounded-full bg-gray-200 hover:bg-gray-300 focus:outline-none"
            (click)="toggleMenu(i)"
          >
            <i class="fas fa-ellipsis-v"></i>
          </button>
          <!-- Dropdown Menu -->
          <div
            *ngIf="menuIndex === i"
            class="absolute right-0 mt-2 w-40 bg-white border border-gray-200 rounded-lg shadow-lg z-10"
          >
            <button
              class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100"
              (click)="updatePost(post)"
            >
              <i class="fas fa-edit mr-2"></i> Update Post
            </button>
            <button
              class="w-full text-left px-4 py-2 text-sm text-red-700 hover:bg-red-100"
              (click)="confirmDelete(post._id)"
            >
              <i class="fas fa-trash mr-2"></i> Delete Post
            </button>
          </div>
        </div>
      </div>
    </div>
    }

  <!-- Delete Confirmation Popup -->
  <div
    *ngIf="showDeletePopup"
    class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-20"
  >
    <div class="bg-white p-6 rounded shadow-lg">
      <h2 class="text-lg font-semibold mb-4">Are you sure?</h2>
      <p class="mb-6">Do you want to delete this post?</p>
      <div class="flex justify-end">
        <button
          class="px-4 py-2 mr-2 bg-red-500 text-white rounded hover:bg-red-600"
          (click)="deletePost()"
        >
          Yes
        </button>
        <button
          class="px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400"
          (click)="closePopup()"
        >
          No
        </button>
      </div>
    </div>
  </div>
</div>
